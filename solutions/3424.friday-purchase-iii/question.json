{"question_id": "3424", "problem_slug": "friday-purchase-iii", "problem_title": "Friday Purchase III ", "content": "Table: Purchases\n\n+---------------+------+\n| Column Name   | Type |\n+---------------+------+\n| user_id       | int  |\n| purchase_date | date |\n| amount_spend  | int  |\n+---------------+------+\n(user_id, purchase_date, amount_spend) is the primary key (combination of columns with unique values) for this table.\npurchase_date will range from November 1, 2023, to November 30, 2023, inclusive of both dates.\nEach row contains user_id, purchase_date, and amount_spend.\n\nTable: Users\n\n+-------------+------+\n| Column Name | Type |\n+-------------+------+\n| user_id     | int  |\n| membership  | enum |\n+-------------+------+\nuser_id is the primary key for this table.\nmembership is an ENUM (category) type of ('Standard', 'Premium', 'VIP').\nEach row of this table indicates the user_id, membership type.\n\nWrite a solution to calculate the total spending by Premium and VIP members on each Friday of every week in November 2023.  If there are no purchases on a particular Friday by Premium or VIP members, it should be considered as 0.\nReturn the result table ordered by week of the month,  and membership in ascending order.\nThe result format is in the following example.\n \nExample:\n\nInput:\nPurchases table:\n\n+---------+---------------+--------------+\n| user_id | purchase_date | amount_spend |\n+---------+---------------+--------------+\n| 11      | 2023-11-03    | 1126         |\n| 15      | 2023-11-10    | 7473         |\n| 17      | 2023-11-17    | 2414         |\n| 12      | 2023-11-24    | 9692         |\n| 8       | 2023-11-24    | 5117         |\n| 1       | 2023-11-24    | 5241         |\n| 10      | 2023-11-22    | 8266         |\n| 13      | 2023-11-21    | 12000        |\n+---------+---------------+--------------+\n\nUsers table:\n\n+---------+------------+\n| user_id | membership |\n+---------+------------+\n| 11      | Premium    |\n| 15      | VIP        |\n| 17      | Standard   |\n| 12      | VIP        |\n| 8       | Premium    |\n| 1       | VIP        |\n| 10      | Standard   |\n| 13      | Premium    |\n+---------+------------+\n\nOutput:\n\n+---------------+-------------+--------------+\n| week_of_month | membership  | total_amount |\n+---------------+-------------+--------------+\n| 1             | Premium     | 1126         |\n| 1             | VIP         | 0            |\n| 2             | Premium     | 0            |\n| 2             | VIP         | 7473         |\n| 3             | Premium     | 0            |\n| 3             | VIP         | 0            |\n| 4             | Premium     | 5117         |\n| 4             | VIP         | 14933        |\n+---------------+-------------+--------------+\n        \nExplanation:\n\nDuring the first week of November 2023, a transaction occurred on Friday, 2023-11-03, by a Premium member amounting to $1,126. No transactions were made by VIP members on this day, resulting in a value of 0.\nFor the second week of November 2023, there was a transaction on Friday, 2023-11-10, and it was made by a VIP member, amounting to $7,473. Since there were no purchases by Premium members that Friday, the output shows 0 for Premium members.\nSimilarly, during the third week of November 2023, no transactions by Premium or VIP members occurred on Friday, 2023-11-17, which shows 0 for both categories in this week.\nIn the fourth week of November 2023, transactions occurred on Friday, 2023-11-24, involving one Premium member purchase of $5,117 and VIP member purchases totaling $14,933 ($9,692 from one and $5,241 from another).\n\nNote: The output table is ordered by week_of_month and membership in ascending order.\n\n", "hints": [], "exampleTestcases": "{\"headers\":{\"Purchases\":[\"user_id\",\"purchase_date\",\"amount_spend\"],\"Users\":[\"user_id\",\"membership\"]},\"rows\":{\"Purchases\":[[11,\"2023-11-03\",1126],[15,\"2023-11-10\",7473],[17,\"2023-11-17\",2414],[12,\"2023-11-24\",9692],[8,\"2023-11-24\",5117],[1,\"2023-11-24\",5241],[10,\"2023-11-22\",8266],[13,\"2023-11-21\",12000]],\"Users\":[[11,\"Premium\"],[15,\"VIP\"],[17,\"Standard\"],[12,\"VIP\"],[8,\"Premium\"],[1,\"VIP\"],[10,\"Standard\"],[13,\"Premium\"]]}}", "codeSnippets": {"MySQL": {"langSlug": "mysql", "code": "# Write your MySQL query statement below\n"}, "MS SQL Server": {"langSlug": "mssql", "code": "/* Write your T-SQL query statement below */\n"}, "Oracle": {"langSlug": "oraclesql", "code": "/* Write your PL/SQL query statement below */\n"}, "Pandas": {"langSlug": "pythondata", "code": "import pandas as pd\n\ndef friday_purchases(purchases: pd.DataFrame, users: pd.DataFrame) -> pd.DataFrame:\n    "}, "PostgreSQL": {"langSlug": "postgresql", "code": "-- Write your PostgreSQL query statement below\n"}}}