{"question_id": "3340", "problem_slug": "snaps-analysis", "problem_title": "Snaps Analysis", "content": "Table: Activities\n\n+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| activity_id   | int     |\n| user_id       | int     |\n| activity_type | enum    |\n| time_spent    | decimal |\n+---------------+---------+\nactivity_id is column of unique values for this table.\nactivity_type is an ENUM (category) type of ('send', 'open'). \nThis table contains activity id, user id, activity type and time spent.\n\nTable: Age\n\n+-------------+------+\n| Column Name | Type |\n+-------------+------+\n| user_id     | int  |\n| age_bucket  | enum |\n+-------------+------+\nuser_id is the column of unique values for this table.\nage_bucket is an ENUM (category) type of ('21-25', '26-30', '31-35'). \nThis table contains user id and age group.\nWrite a solution to calculate the percentage of the total time spent on sending and opening snaps for each age group. Precentage should be rounded to 2 decimal places.\nReturn the result table in any order.\nThe result format is in the following example.\nÂ \nExample 1:\n\nInput: \nActivities table:\n+-------------+---------+---------------+------------+\n| activity_id | user_id | activity_type | time_spent |\n+-------------+---------+---------------+------------+\n| 7274        | 123     | open          | 4.50       | \n| 2425        | 123     | send          | 3.50       | \n| 1413        | 456     | send          | 5.67       | \n| 2536        | 456     | open          | 3.00       | \n| 8564        | 456     | send          | 8.24       | \n| 5235        | 789     | send          | 6.24       | \n| 4251        | 123     | open          | 1.25       | \n| 1435        | 789     | open          | 5.25       | \n+-------------+---------+---------------+------------+\nAge table:\n+---------+------------+\n| user_id | age_bucket | \n+---------+------------+\n| 123     | 31-35      | \n| 789     | 21-25      | \n| 456     | 26-30      | \n+---------+------------+\nOutput: \n+------------+-----------+-----------+\n| age_bucket | send_perc | open_perc |\n+------------+-----------+-----------+\n| 31-35      | 37.84     | 62.16     |\n| 26-30      | 82.26     | 17.74     |\n| 21-25      | 54.31     | 45.69     |\n+------------+-----------+-----------+\nExplanation: \nFor age group 31-35:\n  - There is only one user belonging to this group with the user ID 123.\n  - The total time spent on sending snaps by this user is 3.50, and the time spent on opening snaps is 4.50 + 1.25 = 5.75.\n  - The overall time spent by this user is 3.50 + 5.75 = 9.25.\n  - Therefore, the sending snap percentage will be (3.50 / 9.25) * 100 = 37.84, and the opening snap percentage will be (5.75 / 9.25) * 100 = 62.16.\nFor age group 26-30: \n  - There is only one user belonging to this group with the user ID 456. \n  - The total time spent on sending snaps by this user is 5.67 + 8.24 = 13.91, and the time spent on opening snaps is 3.00. \n  - The overall time spent by this user is 13.91 + 3.00 = 16.91. \n  - Therefore, the sending snap percentage will be (13.91 / 16.91) * 100 = 82.26, and the opening snap percentage will be (3.00 / 16.91) * 100 = 17.74.\nFor age group 21-25: \n  - There is only one user belonging to this group with the user ID 789. \n  - The total time spent on sending snaps by this user is 6.24, and the time spent on opening snaps is 5.25. \n  - The overall time spent by this user is 6.24 + 5.25 = 11.49. \n  - Therefore, the sending snap percentage will be (6.24 / 11.49) * 100 = 54.31, and the opening snap percentage will be (5.25 / 11.49) * 100 = 45.69.\nAll percentages in output table rounded to the two decimal places.\n\n", "hints": [], "exampleTestcases": "{\"headers\":{\"Activities\":[\"activity_id\",\"user_id\",\"activity_type\",\"time_spent\"],\"Age\":[\"user_id\",\"age_bucket\"]},\"rows\":{\"Activities\":[[7274,123,\"open\",4.50],[2425,123,\"send\",3.50],[1413,456,\"send\",5.67],[2536,456,\"open\",3.00],[8564,456,\"send\",8.24],[5235,789,\"send\",6.24],[4251,123,\"open\",1.25],[1435,789,\"open\",5.25]],\"Age\":[[123,\"31-35\"],[789,\"21-25\"],[456,\"26-30\"]]}}", "codeSnippets": {"MySQL": {"langSlug": "mysql", "code": "# Write your MySQL query statement below\n"}, "MS SQL Server": {"langSlug": "mssql", "code": "/* Write your T-SQL query statement below */\n"}, "Oracle": {"langSlug": "oraclesql", "code": "/* Write your PL/SQL query statement below */\n"}, "Pandas": {"langSlug": "pythondata", "code": "import pandas as pd\n\ndef snap_analysis(activities: pd.DataFrame, age: pd.DataFrame) -> pd.DataFrame:\n    "}, "PostgreSQL": {"langSlug": "postgresql", "code": "-- Write your PostgreSQL query statement below\n"}}}