{"questionId": "1702", "acRate": 51.39350412691607, "difficulty": "Medium", "freqBar": 0.0, "frontendQuestionId": "1555", "paidOnly": true, "status": "ac", "title": "Bank Account Summary", "topicTags": [{"name": "Database", "id": "VG9waWNUYWdOb2RlOjYxMDQz", "slug": "database"}], "titleSlug": "bank-account-summary", "content": "<p>Table: <code>Users</code></p>\n\n<pre>\n+--------------+---------+\n| Column Name  | Type    |\n+--------------+---------+\n| user_id      | int     |\n| user_name    | varchar |\n| credit       | int     |\n+--------------+---------+\nuser_id is the primary key (column with unique values) for this table.\nEach row of this table contains the current credit information for each user.\n</pre>\n\n<p>&nbsp;</p>\n\n<p>Table: <code>Transactions</code></p>\n\n<pre>\n+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| trans_id      | int     |\n| paid_by       | int     |\n| paid_to       | int     |\n| amount        | int     |\n| transacted_on | date    |\n+---------------+---------+\ntrans_id is the primary key (column with unique values) for this table.\nEach row of this table contains information about the transaction in the bank.\nUser with id (paid_by) transfer money to user with id (paid_to).\n</pre>\n\n<p>&nbsp;</p>\n\n<p>Leetcode Bank (LCB) helps its coders in making virtual payments. Our bank records all transactions in the table <em>Transaction</em>, we want to find out the current balance of all users and check whether they have breached their credit limit (If their current credit is less than <code>0</code>).</p>\n\n<p>Write a solution&nbsp;to report.</p>\n\n<ul>\n\t<li><code>user_id</code>,</li>\n\t<li><code>user_name</code>,</li>\n\t<li><code>credit</code>, current balance after performing transactions, and</li>\n\t<li><code>credit_limit_breached</code>, check credit_limit (<code>&quot;Yes&quot;</code> or <code>&quot;No&quot;</code>)</li>\n</ul>\n\n<p>Return the result table in <strong>any</strong> order.</p>\n\n<p>The&nbsp;result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> \nUsers table:\n+------------+--------------+-------------+\n| user_id    | user_name    | credit      |\n+------------+--------------+-------------+\n| 1          | Moustafa     | 100         |\n| 2          | Jonathan     | 200         |\n| 3          | Winston      | 10000       |\n| 4          | Luis         | 800         | \n+------------+--------------+-------------+\nTransactions table:\n+------------+------------+------------+----------+---------------+\n| trans_id   | paid_by    | paid_to    | amount   | transacted_on |\n+------------+------------+------------+----------+---------------+\n| 1          | 1          | 3          | 400      | 2020-08-01    |\n| 2          | 3          | 2          | 500      | 2020-08-02    |\n| 3          | 2          | 1          | 200      | 2020-08-03    |\n+------------+------------+------------+----------+---------------+\n<strong>Output:</strong> \n+------------+------------+------------+-----------------------+\n| user_id    | user_name  | credit     | credit_limit_breached |\n+------------+------------+------------+-----------------------+\n| 1          | Moustafa   | -100       | Yes                   | \n| 2          | Jonathan   | 500        | No                    |\n| 3          | Winston    | 9900       | No                    |\n| 4          | Luis       | 800        | No                    |\n+------------+------------+------------+-----------------------+\n<strong>Explanation:</strong> \nMoustafa paid $400 on &quot;2020-08-01&quot; and received $200 on &quot;2020-08-03&quot;, credit (100 -400 +200) = -$100\nJonathan received $500 on &quot;2020-08-02&quot; and paid $200 on &quot;2020-08-08&quot;, credit (200 +500 -200) = $500\nWinston received $400 on &quot;2020-08-01&quot; and paid $500 on &quot;2020-08-03&quot;, credit (10000 +400 -500) = $9990\nLuis did not received any transfer, credit = $800\n</pre>\n", "hints": [], "exampleTestcases": "{\"headers\": {\"Users\": [\"user_id\", \"user_name\", \"credit\"], \"Transactions\": [\"trans_id\", \"paid_by\", \"paid_to\", \"amount\", \"transacted_on\"]}, \"rows\": {\"Users\": [[1, \"Moustafa\", 100], [2, \"Jonathan\", 200], [3, \"Winston\", 10000], [4, \"Luis\", 800]], \"Transactions\": [[1, 1, 3, 400, \"2020-08-01\"], [2, 3, 2, 500, \"2020-08-02\"], [3, 2, 1, 200, \"2020-08-03\"]]}}", "codeSnippets": [{"lang": "MySQL", "langSlug": "mysql", "code": "# Write your MySQL query statement below\n"}, {"lang": "MS SQL Server", "langSlug": "mssql", "code": "/* Write your T-SQL query statement below */\n"}, {"lang": "Oracle", "langSlug": "oraclesql", "code": "/* Write your PL/SQL query statement below */\n"}, {"lang": "Pandas", "langSlug": "pythondata", "code": "import pandas as pd\n\ndef bank_account_summary(users: pd.DataFrame, transactions: pd.DataFrame) -> pd.DataFrame:\n    "}, {"lang": "PostgreSQL", "langSlug": "postgresql", "code": "-- Write your PostgreSQL query statement below\n"}], "similarQuestionList": []}