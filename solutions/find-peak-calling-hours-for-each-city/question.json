{"questionId": "3281", "acRate": 60.83872957138452, "difficulty": "Medium", "freqBar": 0.0, "frontendQuestionId": "2984", "paidOnly": true, "status": "ac", "title": "Find Peak Calling Hours for Each City", "topicTags": [{"name": "Database", "id": "VG9waWNUYWdOb2RlOjYxMDQz", "slug": "database"}], "titleSlug": "find-peak-calling-hours-for-each-city", "content": "<p>Table: <code>Calls</code></p>\n\n<pre>\n+--------------+----------+\n| Column Name  | Type     |\n+--------------+----------+\n| caller_id    | int      |\n| recipient_id | int      |\n| call_time    | datetime |\n| city         | varchar  |\n+--------------+----------+\n(caller_id, recipient_id, call_time) is the primary key (combination of columns with unique values) for this table.\nEach row contains caller id, recipient id, call time, and city.\n</pre>\n\n<p>Write a solution to find the <strong>peak</strong> calling <strong>hour</strong> for each <code>city</code>. If <strong>multiple hours</strong> have the <strong>same</strong> number of calls, all of those hours will be recognized as <strong>peak hours </strong>for that specific city.</p>\n\n<p>Return <em>the result table ordered by <strong>peak calling hour</strong> and </em><code>city</code><em> in <strong>descending</strong></em><em><strong> </strong>order.</em></p>\n\n<p>The result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> \nCalls table:\n+-----------+--------------+---------------------+----------+\n| caller_id | recipient_id | call_time           | city     |\n+-----------+--------------+---------------------+----------+\n| 8         | 4            | 2021-08-24 22:46:07 | Houston  |\n| 4         | 8            | 2021-08-24 22:57:13 | Houston  |  \n| 5         | 1            | 2021-08-11 21:28:44 | Houston  |  \n| 8         | 3            | 2021-08-17 22:04:15 | Houston  |\n| 11        | 3            | 2021-08-17 13:07:00 | New York |\n| 8         | 11           | 2021-08-17 14:22:22 | New York |\n+-----------+--------------+---------------------+----------+\n<strong>Output:</strong> \n+----------+-------------------+-----------------+\n| city     | peak_calling_hour | number_of_calls |\n+----------+-------------------+-----------------+\n| Houston  | 22                | 3               |\n| New York | 14                | 1               |\n| New York | 13                | 1               |\n+----------+-------------------+-----------------+\n<strong>Explanation:</strong> \nFor Houston:\n  - The peak time is 22:00, with a total of 3 calls recorded. \nFor New York:\n  - Both 13:00 and 14:00 hours have equal call counts of 1, so both times are considered peak hours.\nOutput table is ordered by peak_calling_hour and city in descending order.</pre>\n", "hints": [], "exampleTestcases": "{\"headers\":{\"Calls\":[\"caller_id\",\"recipient_id\",\"call_time\",\"city\"]},\"rows\":{\"Calls\":[[8,4,\"2021-08-24 22:46:07\",\"Houston\"],[4,8,\"2021-08-24 22:57:13\",\"Houston\"],[5,1,\"2021-08-11 21:28:44\",\"Houston\"],[8,3,\"2021-08-17 22:04:15\",\"Houston\"],[11,3,\"2021-08-17 13:07:00\",\"New York\"],[8,11,\"2021-08-17 14:22:22\",\"New York\"]]}}", "codeSnippets": [{"lang": "MySQL", "langSlug": "mysql", "code": "# Write your MySQL query statement below\n"}, {"lang": "MS SQL Server", "langSlug": "mssql", "code": "/* Write your T-SQL query statement below */\n"}, {"lang": "Oracle", "langSlug": "oraclesql", "code": "/* Write your PL/SQL query statement below */\n"}, {"lang": "Pandas", "langSlug": "pythondata", "code": "import pandas as pd\n\ndef peak_calling_hours(calls: pd.DataFrame) -> pd.DataFrame:\n    "}, {"lang": "PostgreSQL", "langSlug": "postgresql", "code": "-- Write your PostgreSQL query statement below\n"}], "similarQuestionList": []}