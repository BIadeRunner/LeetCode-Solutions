{"question_id": "579", "problem_slug": "find-cumulative-salary-of-an-employee", "problem_title": "Find Cumulative Salary of an Employee", "content": "Table: Employee\n\n+-------------+------+\n| Column Name | Type |\n+-------------+------+\n| id          | int  |\n| month       | int  |\n| salary      | int  |\n+-------------+------+\n(id, month) is the primary key (combination of columns with unique values) for this table.\nEach row in the table indicates the salary of an employee in one month during the year 2020.\n\n \nWrite a solution to calculate the cumulative salary summary for every employee in a single unified table.\nThe cumulative salary summary for an employee can be calculated as follows:\n\nFor each month that the employee worked, sum up the salaries in that month and the previous two months. This is their 3-month sum for that month. If an employee did not work for the company in previous months, their effective salary for those months is 0.\nDo not include the 3-month sum for the most recent month that the employee worked for in the summary.\nDo not include the 3-month sum for any month the employee did not work.\n\nReturn the result table ordered by id in ascending order. In case of a tie, order it by month in descending order.\nThe result format is in the following example.\n \nExample 1:\n\nInput: \nEmployee table:\n+----+-------+--------+\n| id | month | salary |\n+----+-------+--------+\n| 1  | 1     | 20     |\n| 2  | 1     | 20     |\n| 1  | 2     | 30     |\n| 2  | 2     | 30     |\n| 3  | 2     | 40     |\n| 1  | 3     | 40     |\n| 3  | 3     | 60     |\n| 1  | 4     | 60     |\n| 3  | 4     | 70     |\n| 1  | 7     | 90     |\n| 1  | 8     | 90     |\n+----+-------+--------+\nOutput: \n+----+-------+--------+\n| id | month | Salary |\n+----+-------+--------+\n| 1  | 7     | 90     |\n| 1  | 4     | 130    |\n| 1  | 3     | 90     |\n| 1  | 2     | 50     |\n| 1  | 1     | 20     |\n| 2  | 1     | 20     |\n| 3  | 3     | 100    |\n| 3  | 2     | 40     |\n+----+-------+--------+\nExplanation: \nEmployee '1' has five salary records excluding their most recent month '8':\n- 90 for month '7'.\n- 60 for month '4'.\n- 40 for month '3'.\n- 30 for month '2'.\n- 20 for month '1'.\nSo the cumulative salary summary for this employee is:\n+----+-------+--------+\n| id | month | salary |\n+----+-------+--------+\n| 1  | 7     | 90     |  (90 + 0 + 0)\n| 1  | 4     | 130    |  (60 + 40 + 30)\n| 1  | 3     | 90     |  (40 + 30 + 20)\n| 1  | 2     | 50     |  (30 + 20 + 0)\n| 1  | 1     | 20     |  (20 + 0 + 0)\n+----+-------+--------+\nNote that the 3-month sum for month '7' is 90 because they did not work during month '6' or month '5'.\n\nEmployee '2' only has one salary record (month '1') excluding their most recent month '2'.\n+----+-------+--------+\n| id | month | salary |\n+----+-------+--------+\n| 2  | 1     | 20     |  (20 + 0 + 0)\n+----+-------+--------+\n\nEmployee '3' has two salary records excluding their most recent month '4':\n- 60 for month '3'.\n- 40 for month '2'.\nSo the cumulative salary summary for this employee is:\n+----+-------+--------+\n| id | month | salary |\n+----+-------+--------+\n| 3  | 3     | 100    |  (60 + 40 + 0)\n| 3  | 2     | 40     |  (40 + 0 + 0)\n+----+-------+--------+\n\n", "hints": ["Seem hard at first glance? Try to divide this problem into some sub-problems. \r\nThink about how to calculate the cumulative sum of one employee, how to get the cumulative sum for many employees, and how to except the most recent month of the result.", "Use the technique of self-join if you have only one table but to write a complex query.", "Still remember how to use the function `sum` and `max`?"], "exampleTestcases": "{\"headers\":{\"Employee\":[\"id\",\"month\",\"salary\"]},\"rows\":{\"Employee\":[[1,1,20],[2,1,20],[1,2,30],[2,2,30],[3,2,40],[1,3,40],[3,3,60],[1,4,60],[3,4,70],[1,7,90],[1,8,90]]}}", "codeSnippets": {"MySQL": {"langSlug": "mysql", "code": "# Write your MySQL query statement below\n"}, "MS SQL Server": {"langSlug": "mssql", "code": "/* Write your T-SQL query statement below */\n"}, "Oracle": {"langSlug": "oraclesql", "code": "/* Write your PL/SQL query statement below */\n"}, "Pandas": {"langSlug": "pythondata", "code": "import pandas as pd\n\ndef cumulative_salary(employee: pd.DataFrame) -> pd.DataFrame:\n    "}, "PostgreSQL": {"langSlug": "postgresql", "code": "-- Write your PostgreSQL query statement below\n"}}}