{"questionId": "569", "acRate": 65.88353568942851, "difficulty": "Hard", "freqBar": 34.213770810818, "frontendQuestionId": "569", "paidOnly": true, "status": "ac", "title": "Median Employee Salary", "topicTags": [{"name": "Database", "id": "VG9waWNUYWdOb2RlOjYxMDQz", "slug": "database"}], "titleSlug": "median-employee-salary", "content": "<p>Table: <code>Employee</code></p>\n\n<pre>\n+--------------+---------+\n| Column Name  | Type    |\n+--------------+---------+\n| id           | int     |\n| company      | varchar |\n| salary       | int     |\n+--------------+---------+\nid is the primary key (column with unique values) for this table.\nEach row of this table indicates the company and the salary of one employee.\n</pre>\n\n<p>&nbsp;</p>\n\n<p>Write a solution to find the rows that contain the median salary of each company. While calculating the median, when you sort the salaries of the company, break the ties by <code>id</code>.</p>\n\n<p>Return the result table in <strong>any order</strong>.</p>\n\n<p>The result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> \nEmployee table:\n+----+---------+--------+\n| id | company | salary |\n+----+---------+--------+\n| 1  | A       | 2341   |\n| 2  | A       | 341    |\n| 3  | A       | 15     |\n| 4  | A       | 15314  |\n| 5  | A       | 451    |\n| 6  | A       | 513    |\n| 7  | B       | 15     |\n| 8  | B       | 13     |\n| 9  | B       | 1154   |\n| 10 | B       | 1345   |\n| 11 | B       | 1221   |\n| 12 | B       | 234    |\n| 13 | C       | 2345   |\n| 14 | C       | 2645   |\n| 15 | C       | 2645   |\n| 16 | C       | 2652   |\n| 17 | C       | 65     |\n+----+---------+--------+\n<strong>Output:</strong> \n+----+---------+--------+\n| id | company | salary |\n+----+---------+--------+\n| 5  | A       | 451    |\n| 6  | A       | 513    |\n| 12 | B       | 234    |\n| 9  | B       | 1154   |\n| 14 | C       | 2645   |\n+----+---------+--------+\n<strong>Explanation:</strong> \nFor company A, the rows sorted are as follows:\n+----+---------+--------+\n| id | company | salary |\n+----+---------+--------+\n| 3  | A       | 15     |\n| 2  | A       | 341    |\n| 5  | A       | 451    | &lt;-- median\n| 6  | A       | 513    | &lt;-- median\n| 1  | A       | 2341   |\n| 4  | A       | 15314  |\n+----+---------+--------+\nFor company B, the rows sorted are as follows:\n+----+---------+--------+\n| id | company | salary |\n+----+---------+--------+\n| 8  | B       | 13     |\n| 7  | B       | 15     |\n| 12 | B       | 234    | &lt;-- median\n| 11 | B       | 1221   | &lt;-- median\n| 9  | B       | 1154   |\n| 10 | B       | 1345   |\n+----+---------+--------+\nFor company C, the rows sorted are as follows:\n+----+---------+--------+\n| id | company | salary |\n+----+---------+--------+\n| 17 | C       | 65     |\n| 13 | C       | 2345   |\n| 14 | C       | 2645   | &lt;-- median\n| 15 | C       | 2645   | \n| 16 | C       | 2652   |\n+----+---------+--------+\n</pre>\n\n<p>&nbsp;</p>\n<p><strong>Follow up:</strong> Could you solve it without using any built-in or window functions?</p>\n", "hints": ["Still remember how to select the sum which group by one column?", "Try to think about how to get the median from a sorted list.", "How to get the median one item for odd number list while how to get the median two items for even number list, try to unify them."], "exampleTestcases": "{\"headers\": {\"Employee\": [\"id\", \"company\", \"salary\"]}, \"rows\": {\"Employee\": [[1, \"A\", 2341],[2, \"A\", 341],[3, \"A\", 15],[4, \"A\", 15314],[5, \"A\", 451],[6, \"A\", 513],[7, \"B\", 15],[8, \"B\", 13],[9, \"B\", 1154],[10, \"B\", 1345],[11, \"B\", 1221],[12, \"B\", 234],[13, \"C\", 2345],[14, \"C\", 2645],[15, \"C\", 2645],[16, \"C\", 2652],[17, \"C\", 65]]}}", "codeSnippets": [{"lang": "MySQL", "langSlug": "mysql", "code": "# Write your MySQL query statement below\n"}, {"lang": "MS SQL Server", "langSlug": "mssql", "code": "/* Write your T-SQL query statement below */\n"}, {"lang": "Oracle", "langSlug": "oraclesql", "code": "/* Write your PL/SQL query statement below */\n"}, {"lang": "Pandas", "langSlug": "pythondata", "code": "import pandas as pd\n\ndef median_employee_salary(employee: pd.DataFrame) -> pd.DataFrame:\n    "}, {"lang": "PostgreSQL", "langSlug": "postgresql", "code": "-- Write your PostgreSQL query statement below\n"}], "similarQuestionList": [{"difficulty": "Hard", "titleSlug": "find-median-given-frequency-of-numbers", "title": "Find Median Given Frequency of Numbers", "isPaidOnly": true}]}