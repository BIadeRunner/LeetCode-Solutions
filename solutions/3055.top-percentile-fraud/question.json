{"questionId": "3339", "acRate": 58.10246679316889, "difficulty": "Medium", "freqBar": 0.0, "frontendQuestionId": "3055", "paidOnly": true, "status": "ac", "title": "Top Percentile Fraud", "titleSlug": "top-percentile-fraud", "topicTags": [{"name": "Database", "id": "VG9waWNUYWdOb2RlOjYxMDQz", "slug": "database"}], "content": "<p>Table: <code>Fraud</code></p>\n\n<pre>\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| policy_id   | int     |\n| state       | varchar |\n| fraud_score | int     |\n+-------------+---------+\npolicy_id is column of unique values for this table.\nThis table contains policy id, state, and fraud score.\n</pre>\n\n<p>The Leetcode Insurance Corp has developed an ML-driven <strong>predictive model </strong>to detect the <strong>likelihood</strong> of fraudulent claims. Consequently, they allocate their most seasoned claim adjusters to address the top <code>5%</code> of <strong>claims</strong> <strong>flagged</strong> by this model.</p>\n\n<p>Write a solution to find the top <code>5</code> <strong>percentile</strong> of claims from <strong>each state</strong>.</p>\n\n<p>Return <em>the result table ordered by </em><code>state</code><em> in <strong>ascending</strong> order, </em><code>fraud_score</code><em> in <strong>descending</strong> order, and </em><code>policy_id</code><em> in <strong>ascending</strong> order.</em></p>\n\n<p>The result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example 1:</strong></p>\n\n<pre>\n<strong>Input:</strong> \nFraud table:\n+-----------+------------+-------------+\n| policy_id | state      | fraud_score | \n+-----------+------------+-------------+\n| 1         | California | 0.92        | \n| 2         | California | 0.68        |   \n| 3         | California | 0.17        | \n| 4         | New York   | 0.94        | \n| 5         | New York   | 0.81        | \n| 6         | New York   | 0.77        |  \n| 7         | Texas      | 0.98        |  \n| 8         | Texas      | 0.97        | \n| 9         | Texas      | 0.96        | \n| 10        | Florida    | 0.97        |  \n| 11        | Florida    | 0.98        | \n| 12        | Florida    | 0.78        | \n| 13        | Florida    | 0.88        | \n| 14        | Florida    | 0.66        | \n+-----------+------------+-------------+\n<strong>Output:</strong> \n+-----------+------------+-------------+\n| policy_id | state      | fraud_score |\n+-----------+------------+-------------+\n| 1         | California | 0.92        | \n| 11        | Florida    | 0.98        | \n| 4         | New York   | 0.94        | \n| 7         | Texas      | 0.98        |  \n+-----------+------------+-------------+\n<strong>Explanation</strong>\n- For the state of California, only policy ID 1, with a fraud score of 0.92, falls within the top 5 percentile for this state.\n- For the state of Florida, only policy ID 11, with a fraud score of 0.98, falls within the top 5 percentile for this state. \n- For the state of New York, only policy ID 4, with a fraud score of 0.94, falls within the top 5 percentile for this state. \n- For the state of Texas, only policy ID 7, with a fraud score of 0.98, falls within the top 5 percentile for this state. \nOutput table is ordered by state in ascending order, fraud score in descending order, and policy ID in ascending order.\n</pre>\n", "hints": [], "exampleTestcases": "{\"headers\":{\"Fraud\":[\"policy_id\",\"state\",\"fraud_score\"]},\"rows\":{\"Fraud\":[[1,\"California\",0.92],[2,\"California\",0.68],[3,\"California\",0.17],[4,\"New York\",0.94],[5,\"New York\",0.81],[6,\"New York\",0.77],[7,\"Texas\",0.98],[8,\"Texas\",0.97],[9,\"Texas\",0.96],[10,\"Florida\",0.97],[11,\"Florida\",0.98],[12,\"Florida\",0.78],[13,\"Florida\",0.88],[14,\"Florida\",0.66]]}}", "codeSnippets": [{"lang": "MySQL", "langSlug": "mysql", "code": "# Write your MySQL query statement below\n"}, {"lang": "MS SQL Server", "langSlug": "mssql", "code": "/* Write your T-SQL query statement below */\n"}, {"lang": "Oracle", "langSlug": "oraclesql", "code": "/* Write your PL/SQL query statement below */\n"}, {"lang": "Pandas", "langSlug": "pythondata", "code": "import pandas as pd\n\ndef top_percentile_fraud(fraud: pd.DataFrame) -> pd.DataFrame:\n    "}, {"lang": "PostgreSQL", "langSlug": "postgresql", "code": "-- Write your PostgreSQL query statement below\n"}], "similarQuestionList": []}