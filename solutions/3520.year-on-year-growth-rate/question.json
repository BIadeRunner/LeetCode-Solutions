{"question_id": "3520", "problem_slug": "year-on-year-growth-rate", "problem_title": "Year on Year Growth Rate", "content": "Table: user_transactions\n\n+------------------+----------+\n| Column Name      | Type     | \n+------------------+----------+\n| transaction_id   | integer  |\n| product_id       | integer  |\n| spend            | decimal  |\n| transaction_date | datetime |\n+------------------+----------+\nThe transaction_id column uniquely identifies each row in this table.\nEach row of this table contains the transaction ID, product ID, the spend amount, and the transaction date.\n\nWrite a solution to calculate the year-on-year growth rate for the total spend for each product.\nThe result table should include the following columns:\n\nyear: The year of the transaction.\nproduct_id: The ID of the product.\ncurr_year_spend: The total spend for the current year.\nprev_year_spend: The total spend for the previous year.\nyoy_rate: The year-on-year growth rate percentage, rounded to 2 decimal places.\n\nReturn the result table ordered by product_id,year in ascending order.\nThe result format is in the following example.\n \nExample:\n\nInput:\nuser_transactions table:\n\n+----------------+------------+---------+---------------------+\n| transaction_id | product_id | spend   | transaction_date    |\n+----------------+------------+---------+---------------------+\n| 1341           | 123424     | 1500.60 | 2019-12-31 12:00:00 |\n| 1423           | 123424     | 1000.20 | 2020-12-31 12:00:00 |\n| 1623           | 123424     | 1246.44 | 2021-12-31 12:00:00 |\n| 1322           | 123424     | 2145.32 | 2022-12-31 12:00:00 |\n+----------------+------------+---------+---------------------+\n\nOutput:\n\n+------+------------+----------------+----------------+----------+\n| year | product_id | curr_year_spend| prev_year_spend| yoy_rate |\n+------+------------+----------------+----------------+----------+\n| 2019 | 123424     | 1500.60        | NULL           | NULL     |\n| 2020 | 123424     | 1000.20        | 1500.60        | -33.35   |\n| 2021 | 123424     | 1246.44        | 1000.20        | 24.62    |\n| 2022 | 123424     | 2145.32        | 1246.44        | 72.12    |\n+------+------------+----------------+----------------+----------+\n\nExplanation:\n\nFor product ID 123424:\n\t\nIn 2019:\n\t\t\nCurrent year's spend is 1500.60\nNo previous year's spend recorded\nYoY growth rate: NULL\n\n\nIn 2020:\n\t\t\nCurrent year's spend is 1000.20\nPrevious year's spend is 1500.60\nYoY growth rate: ((1000.20 - 1500.60) / 1500.60) * 100 = -33.35%\n\n\nIn 2021:\n\t\t\nCurrent year's spend is 1246.44\nPrevious year's spend is 1000.20\nYoY growth rate: ((1246.44 - 1000.20) / 1000.20) * 100 = 24.62%\n\n\nIn 2022:\n\t\t\nCurrent year's spend is 2145.32\nPrevious year's spend is 1246.44\nYoY growth rate: ((2145.32 - 1246.44) / 1246.44) * 100 = 72.12%\n\n\n\n\n\nNote: Output table is ordered by product_id and year in ascending order.\n\n", "hints": [], "exampleTestcases": "{\"headers\":{\"user_transactions\":[\"transaction_id\",\"product_id\",\"spend\",\"transaction_date\"]},\"rows\":{\"user_transactions\":[[1341,123424,1500.60,\"2019-12-31 12:00:00\"],[1423,123424,1000.20,\"2020-12-31 12:00:00\"],[1623,123424,1246.44,\"2021-12-31 12:00:00\"],[1322,123424,2145.32,\"2022-12-31 12:00:00\"]]}}", "codeSnippets": {"MySQL": {"langSlug": "mysql", "code": "# Write your MySQL query statement below\n"}, "MS SQL Server": {"langSlug": "mssql", "code": "/* Write your T-SQL query statement below */\n"}, "Oracle": {"langSlug": "oraclesql", "code": "/* Write your PL/SQL query statement below */\n"}, "Pandas": {"langSlug": "pythondata", "code": "import pandas as pd\n\ndef calculate_yoy_growth(user_transactions: pd.DataFrame) -> pd.DataFrame:\n    "}, "PostgreSQL": {"langSlug": "postgresql", "code": "-- Write your PostgreSQL query statement below\n"}}}