{"question_id": "3287", "problem_slug": "loan-types", "problem_title": "Loan Types", "content": "Table: Loans\n\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| loan_id     | int     |\n| user_id     | int     |\n| loan_type   | varchar |\n+-------------+---------+\nloan_id is column of unique values for this table.\nThis table contains loan_id, user_id, and loan_type.\n\nWrite a solution to find all distinct user_id's that have at least one Refinance loan type and at least one Mortgage loan type.\nReturn the result table ordered by user_id in ascending order.\nThe result format is in the following example.\nÂ \nExample 1:\n\nInput:\nLoans table:\n+---------+---------+-----------+\n| loan_id | user_id | loan_type |\n+---------+---------+-----------+\n| 683     | 101     | Mortgage  |\n| 218     | 101     | AutoLoan  |\n| 802     | 101     | Inschool  |\n| 593     | 102     | Mortgage  |\n| 138     | 102     | Refinance |\n| 294     | 102     | Inschool  |\n| 308     | 103     | Refinance |\n| 389     | 104     | Mortgage  |\n+---------+---------+-----------+\nOutput\n+---------+\n| user_id | \n+---------+\n| 102     | \n+---------+\nExplanation\n- User_id 101 has three loan types, one of which is a Mortgage. However, this user does not have any loan type categorized as Refinance, so user_id 101 won't be considered.\n- User_id 102 possesses three loan types: one for Mortgage and one for Refinance. Hence, user_id 102 will be included in the result.\n- User_id 103 has a loan type of Refinance but lacks a Mortgage loan type, so user_id 103 won't be considered.\n- User_id 104 has a Mortgage loan type but doesn't have a Refinance loan type, thus, user_id 104 won't be considered.\nOutput table is ordered by user_id in ascending order.\n\n", "hints": [], "exampleTestcases": "{\"headers\":{\"Loans\":[\"loan_id\",\"user_id\",\"loan_type\"]},\"rows\":{\"Loans\":[[683,101,\"Mortgage\"],[218,101,\"AutoLoan\"],[802,101,\"Inschool\"],[593,102,\"Mortgage\"],[138,102,\"Refinance\"],[294,102,\"Inschool\"],[308,103,\"Refinance\"],[389,104,\"Mortgage\"]]}}", "codeSnippets": {"MySQL": {"langSlug": "mysql", "code": "# Write your MySQL query statement below\n"}, "MS SQL Server": {"langSlug": "mssql", "code": "/* Write your T-SQL query statement below */\n"}, "Oracle": {"langSlug": "oraclesql", "code": "/* Write your PL/SQL query statement below */\n"}, "Pandas": {"langSlug": "pythondata", "code": "import pandas as pd\n\ndef loan_types(loans: pd.DataFrame) -> pd.DataFrame:\n    "}, "PostgreSQL": {"langSlug": "postgresql", "code": "-- Write your PostgreSQL query statement below\n"}}}