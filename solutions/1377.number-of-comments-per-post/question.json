{"question_id": "1377", "problem_slug": "number-of-comments-per-post", "problem_title": "Number of Comments per Post", "content": "Table: Submissions\n\n+---------------+----------+\n| Column Name   | Type     |\n+---------------+----------+\n| sub_id        | int      |\n| parent_id     | int      |\n+---------------+----------+\nThis table may have duplicate rows.\nEach row can be a post or comment on the post.\nparent_id is null for posts.\nparent_id for comments is sub_id for another post in the table.\n\n \nWrite a solution to find the number of comments per post. The result table should contain post_id and its corresponding number_of_comments.\nThe Submissions table may contain duplicate comments. You should count the number of unique comments per post.\nThe Submissions table may contain duplicate posts. You should treat them as one post.\nThe result table should be ordered by post_id in ascending order.\nThe result format is in the following example.\n \nExample 1:\n\nInput: \nSubmissions table:\n+---------+------------+\n| sub_id  | parent_id  |\n+---------+------------+\n| 1       | Null       |\n| 2       | Null       |\n| 1       | Null       |\n| 12      | Null       |\n| 3       | 1          |\n| 5       | 2          |\n| 3       | 1          |\n| 4       | 1          |\n| 9       | 1          |\n| 10      | 2          |\n| 6       | 7          |\n+---------+------------+\nOutput: \n+---------+--------------------+\n| post_id | number_of_comments |\n+---------+--------------------+\n| 1       | 3                  |\n| 2       | 2                  |\n| 12      | 0                  |\n+---------+--------------------+\nExplanation: \nThe post with id 1 has three comments in the table with id 3, 4, and 9. The comment with id 3 is repeated in the table, we counted it only once.\nThe post with id 2 has two comments in the table with id 5 and 10.\nThe post with id 12 has no comments in the table.\nThe comment with id 6 is a comment on a deleted post with id 7 so we ignored it.\n\n", "hints": [], "exampleTestcases": "{\"headers\":{\"Submissions\":[\"sub_id\",\"parent_id\"]},\"rows\":{\"Submissions\":[[1,null],[2,null],[1,null],[12,null],[3,1],[5,2],[3,1],[4,1],[9,1],[10,2],[6,7]]}}", "codeSnippets": {"MySQL": {"langSlug": "mysql", "code": "# Write your MySQL query statement below\n"}, "MS SQL Server": {"langSlug": "mssql", "code": "/* Write your T-SQL query statement below */\n"}, "Oracle": {"langSlug": "oraclesql", "code": "/* Write your PL/SQL query statement below */\n"}, "Pandas": {"langSlug": "pythondata", "code": "import pandas as pd\n\ndef count_comments(submissions: pd.DataFrame) -> pd.DataFrame:\n    "}, "PostgreSQL": {"langSlug": "postgresql", "code": "-- Write your PostgreSQL query statement below\n"}}}