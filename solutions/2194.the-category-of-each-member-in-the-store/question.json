{"question_id": "2194", "problem_slug": "the-category-of-each-member-in-the-store", "problem_title": "The Category of Each Member in the Store", "content": "Table: Members\n\n+-------------+---------+\n| Column Name | Type    |\n+-------------+---------+\n| member_id   | int     |\n| name        | varchar |\n+-------------+---------+\nmember_id is the column with unique values for this table.\nEach row of this table indicates the name and the ID of a member.\n\n \nTable: Visits\n\n+-------------+------+\n| Column Name | Type |\n+-------------+------+\n| visit_id    | int  |\n| member_id   | int  |\n| visit_date  | date |\n+-------------+------+\nvisit_id is the column with unique values for this table.\nmember_id is a foreign key (reference column) to member_id from the Members table.\nEach row of this table contains information about the date of a visit to the store and the member who visited it.\n\n \nTable: Purchases\n\n+----------------+------+\n| Column Name    | Type |\n+----------------+------+\n| visit_id       | int  |\n| charged_amount | int  |\n+----------------+------+\nvisit_id is the column with unique values for this table.\nvisit_id is a foreign key (reference column) to visit_id from the Visits table.\nEach row of this table contains information about the amount charged in a visit to the store.\n\n \nA store wants to categorize its members. There are three tiers:\n\n\"Diamond\": if the conversion rate is greater than or equal to 80.\n\"Gold\": if the conversion rate is greater than or equal to 50 and less than 80.\n\"Silver\": if the conversion rate is less than 50.\n\"Bronze\": if the member never visited the store.\n\nThe conversion rate of a member is (100 * total number of purchases for the member) / total number of visits for the member.\nWrite a solution to report the id, the name, and the category of each member.\nReturn the result table in any order.\nThe result format is in the following example.\n \nExample 1:\n\nInput: \nMembers table:\n+-----------+---------+\n| member_id | name    |\n+-----------+---------+\n| 9         | Alice   |\n| 11        | Bob     |\n| 3         | Winston |\n| 8         | Hercy   |\n| 1         | Narihan |\n+-----------+---------+\nVisits table:\n+----------+-----------+------------+\n| visit_id | member_id | visit_date |\n+----------+-----------+------------+\n| 22       | 11        | 2021-10-28 |\n| 16       | 11        | 2021-01-12 |\n| 18       | 9         | 2021-12-10 |\n| 19       | 3         | 2021-10-19 |\n| 12       | 11        | 2021-03-01 |\n| 17       | 8         | 2021-05-07 |\n| 21       | 9         | 2021-05-12 |\n+----------+-----------+------------+\nPurchases table:\n+----------+----------------+\n| visit_id | charged_amount |\n+----------+----------------+\n| 12       | 2000           |\n| 18       | 9000           |\n| 17       | 7000           |\n+----------+----------------+\nOutput: \n+-----------+---------+----------+\n| member_id | name    | category |\n+-----------+---------+----------+\n| 1         | Narihan | Bronze   |\n| 3         | Winston | Silver   |\n| 8         | Hercy   | Diamond  |\n| 9         | Alice   | Gold     |\n| 11        | Bob     | Silver   |\n+-----------+---------+----------+\nExplanation: \n- User Narihan with id = 1 did not make any visits to the store. She gets a Bronze category.\n- User Winston with id = 3 visited the store one time and did not purchase anything. The conversion rate = (100 * 0) / 1 = 0. He gets a Silver category.\n- User Hercy with id = 8 visited the store one time and purchased one time. The conversion rate = (100 * 1) / 1 = 1. He gets a Diamond category.\n- User Alice with id = 9 visited the store two times and purchased one time. The conversion rate = (100 * 1) / 2 = 50. She gets a Gold category.\n- User Bob with id = 11 visited the store three times and purchased one time. The conversion rate = (100 * 1) / 3 = 33.33. He gets a Silver category.\n\n", "hints": [], "exampleTestcases": "{\"headers\":{\"Members\":[\"member_id\",\"name\"],\"Visits\":[\"visit_id\",\"member_id\",\"visit_date\"],\"Purchases\":[\"visit_id\",\"charged_amount\"]},\"rows\":{\"Members\":[[9,\"Alice\"],[11,\"Bob\"],[3,\"Winston\"],[8,\"Hercy\"],[1,\"Narihan\"]],\"Visits\":[[22,11,\"2021-10-28\"],[16,11,\"2021-01-12\"],[18,9,\"2021-12-10\"],[19,3,\"2021-10-19\"],[12,11,\"2021-03-01\"],[17,8,\"2021-05-07\"],[21,9,\"2021-05-12\"]],\"Purchases\":[[12,2000],[18,9000],[17,7000]]}}", "codeSnippets": {"MySQL": {"langSlug": "mysql", "code": "# Write your MySQL query statement below\n"}, "MS SQL Server": {"langSlug": "mssql", "code": "/* Write your T-SQL query statement below */\n"}, "Oracle": {"langSlug": "oraclesql", "code": "/* Write your PL/SQL query statement below */\n"}, "Pandas": {"langSlug": "pythondata", "code": "import pandas as pd\n\ndef find_categories(members: pd.DataFrame, visits: pd.DataFrame, purchases: pd.DataFrame) -> pd.DataFrame:\n    "}, "PostgreSQL": {"langSlug": "postgresql", "code": "-- Write your PostgreSQL query statement below\n"}}}