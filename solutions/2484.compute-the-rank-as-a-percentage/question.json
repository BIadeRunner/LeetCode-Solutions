{"question_id": "2484", "problem_slug": "compute-the-rank-as-a-percentage", "problem_title": "Compute the Rank as a Percentage", "content": "Table: Students\n\n+---------------+------+\n| Column Name   | Type |\n+---------------+------+\n| student_id    | int  |\n| department_id | int  |\n| mark          | int  |\n+---------------+------+\nstudent_id contains unique values.\nEach row of this table indicates a student's ID, the ID of the department in which the student enrolled, and their mark in the exam.\n\n \nWrite a solution to report the rank of each student in their department as a percentage, where the rank as a percentage is computed using the following formula: (student_rank_in_the_department - 1) * 100 / (the_number_of_students_in_the_department - 1). The percentage should be rounded to 2 decimal places. student_rank_in_the_department is determined by descending mark, such that the student with the highest mark is rank 1. If two students get the same mark, they also get the same rank.\nReturn the result table in any order.\nThe result format is in the following example.\n \nExample 1:\n\nInput: \nStudents table:\n+------------+---------------+------+\n| student_id | department_id | mark |\n+------------+---------------+------+\n| 2          | 2             | 650  |\n| 8          | 2             | 650  |\n| 7          | 1             | 920  |\n| 1          | 1             | 610  |\n| 3          | 1             | 530  |\n+------------+---------------+------+\nOutput: \n+------------+---------------+------------+\n| student_id | department_id | percentage |\n+------------+---------------+------------+\n| 7          | 1             | 0.0        |\n| 1          | 1             | 50.0       |\n| 3          | 1             | 100.0      |\n| 2          | 2             | 0.0        |\n| 8          | 2             | 0.0        |\n+------------+---------------+------------+\nExplanation: \nFor Department 1:\n - Student 7: percentage = (1 - 1) * 100 / (3 - 1) = 0.0\n - Student 1: percentage = (2 - 1) * 100 / (3 - 1) = 50.0\n - Student 3: percentage = (3 - 1) * 100 / (3 - 1) = 100.0\nFor Department 2:\n - Student 2: percentage = (1 - 1) * 100 / (2 - 1) = 0.0\n - Student 8: percentage = (1 - 1) * 100 / (2 - 1) = 0.0\n\n", "hints": [], "exampleTestcases": "{\"headers\": {\"Students\": [\"student_id\", \"department_id\", \"mark\"]}, \"rows\": {\"Students\": [[2, 2, 650], [8, 2, 650], [7, 1, 920], [1, 1, 610], [3, 1, 530]]}}", "codeSnippets": {"MySQL": {"langSlug": "mysql", "code": "# Write your MySQL query statement below\n"}, "MS SQL Server": {"langSlug": "mssql", "code": "/* Write your T-SQL query statement below */\n"}, "Oracle": {"langSlug": "oraclesql", "code": "/* Write your PL/SQL query statement below */\n"}, "Pandas": {"langSlug": "pythondata", "code": "import pandas as pd\n\ndef compute_rating(students: pd.DataFrame) -> pd.DataFrame:\n    "}, "PostgreSQL": {"langSlug": "postgresql", "code": "-- Write your PostgreSQL query statement below\n"}}}